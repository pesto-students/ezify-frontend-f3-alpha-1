"use strict";(self.webpackChunkezzify_pesto_frontend=self.webpackChunkezzify_pesto_frontend||[]).push([[972],{3972:function(e,n,t){t.r(n),t.d(n,{default:function(){return y}});var i=t(1413),r=t(5861),s=t(885),a=t(7757),l=t.n(a),o=t(2791),u=t(6864),c=t(6863),d=t(364),f=t(9271),m=t(6649),p=t(6727),v=t(9748),x=t(7391),b=t(5335),h=t(6606),j=t(5308),k=t(184),y=(0,d.$j)(null,(function(e){return{setToken:function(n){return e((0,j.s)(n))},setUser:function(n){return e((0,j.l)(n))}}}))((0,f.withRouter)((function(e){var n=e.setUser,t=e.setToken,a=e.history,d=(0,o.useContext)(x.D),f=(0,u.TA)({initialValues:{email:"",otp:"",id:""},validationSchema:c.Ry({email:c.Z_().email().min(3).required("Required"),otp:c.Z_().min(4).max(4).required("Required"),id:c.Z_().required("Required")}),onSubmit:function(e){V()}}),j={id:"email",label:"Email",isMandatory:!0,type:"input-formik",formik:f},y={id:"otp",label:"OTP",isMandatory:!0,type:"input-formik",formik:f},_=(0,o.useState)({type:"submit",text:"Login",classes:"btn-block font-weight-bold",disabled:!0}),w=(0,s.Z)(_,2),g=w[0],Z=w[1];(0,o.useEffect)((function(){f.validateForm()}),[]),(0,o.useEffect)((function(){Z({type:"submit",text:"Login",classes:"btn-block font-weight-bold",disabled:!f.isValid})}),[f.isValid]);var N=function(){var e=(0,r.Z)(l().mark((function e(){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!f.values.email){e.next=6;break}return e.next=3,(0,h.e)(T);case 3:n=e.sent,f.setFieldValue("id",n._id),console.log("otpVerify",n.otpVerify);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=(0,r.Z)(l().mark((function e(){var n,t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={email:f.values.email},e.next=3,d.postData(b.Y.SEND_OTP,n);case 3:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=(0,r.Z)(l().mark((function e(){var i,r,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.e)(E);case 2:if(s=e.sent,console.log(s),console.log("admin"!==(null===s||void 0===s||null===(i=s.user)||void 0===i?void 0:i.roles)),"10001"!==(null===s||void 0===s?void 0:s.statusCode)){e.next=8;break}return f.setFieldError("otp","Invalid OTP"),e.abrupt("return");case 8:if("admin"===(null===s||void 0===s||null===(r=s.user)||void 0===r?void 0:r.roles)){e.next=13;break}return f.setFieldValue("otp","",!1),f.setFieldValue("id",null,!1),f.setFieldError("email","This email is not of admin"),e.abrupt("return");case 13:n(s.user),t(s.token),a.push("/dashboard");case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=(0,r.Z)(l().mark((function e(){var n,t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={id:f.values.id,otp:f.values.otp},e.next=3,d.postData(b.Y.VERIFY_OTP,n);case 3:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,k.jsx)("div",{className:"container-fluid admin",children:(0,k.jsxs)("div",{className:"row",children:[(0,k.jsx)("div",{className:"col-md-6 px-0 d-flex align-items-center justify-content-center admin__container--left",children:(0,k.jsx)("div",{className:"admin__left d-flex align-items-center justify-content-center",children:(0,k.jsx)("img",{src:m,alt:"Banner"})})}),(0,k.jsx)("div",{className:"col-md-6 d-flex align-items-center justify-content-center admin__container--right",children:(0,k.jsx)("form",{className:"admin__login",onSubmit:f.handleSubmit,children:(0,k.jsxs)("div",{className:"admin__login--container d-flex flex-column align-items-center justify-content-between",children:[(0,k.jsx)("h3",{className:"mb-3",children:"Login as Admin"}),(0,k.jsxs)("div",{className:"w-100",children:[(0,k.jsx)(v.Z,(0,i.Z)({},j)),(0,k.jsx)("div",{className:"sendOTP",children:(0,k.jsx)("span",{className:f.errors.email?"disable":null,onClick:N,children:"Send OTP"})})]}),(0,k.jsx)("div",{className:"w-100 mb-4",children:(0,k.jsx)(v.Z,(0,i.Z)({},y))}),(0,k.jsx)(p.Z,(0,i.Z)({},g))]})})})]})})})))},6649:function(e,n,t){e.exports=t.p+"static/media/banner.9ef3e1e47e4ddf49bbb2.webp"}}]);
//# sourceMappingURL=972.f3f4dc57.chunk.js.map