"use strict";(self.webpackChunkezzify_pesto_frontend=self.webpackChunkezzify_pesto_frontend||[]).push([[45],{4045:function(e,t,n){n.r(t),n.d(t,{default:function(){return z}});var r=n(1413),s=n(5861),a=n(885),i=n(7757),c=n.n(i),l=n(2791),o=n(7391),u=n(6606),d=n(5335),m=n(7653),f=n(4667),p=n(2982),v=n(44),h=n(6864),x=n(6863),g=n(6916),j=n(9748),b=n(6727),w=n(4872),S=n(364),N=n(7915),Z=n(184),y=(0,g.zB)({userToken:w.r}),_=(0,S.$j)(y,(function(e){return{setToasterCofig:function(t){return e((0,N.g)(t))}}}))((function(e){var t=e.setShow,n=e.userToken,i=e.setToasterCofig,m=e.setServices,f=e.data,g=e.updateServices,w=(0,l.useContext)(o.D),S=(0,l.useState)(null!==f&&void 0!==f&&f.image?f.image:null),N=(0,a.Z)(S,2),y=N[0],_=N[1],E=["image/png","image/jpeg","image/jpg"],k=(0,h.TA)({initialValues:{id:null!==f&&void 0!==f&&f._id?f._id:"",imgValidation:!(null===f||void 0===f||!f._id),name:null!==f&&void 0!==f&&f.name?f.name:"",description:null!==f&&void 0!==f&&f.description?f.description:"",file:""},validationSchema:x.Ry({name:x.Z_().min(3).max(20).required("Required"),description:x.Z_().min(15).max(300).required("Required"),file:x.nK().when("imgValidation",{is:!1,then:x.nK().required().test("FILE_SIZE","File should be less than 3mb",(function(e){return!e||e&&e.size>3072})).test("FILE_FORMAT","File should be in png/jpg/jpeg format",(function(e){return!e||e&&E.includes(null===e||void 0===e?void 0:e.type)})),otherwise:x.nK().nullable()})}),onSubmit:function(e){f?B():R()}}),C={id:"name",label:"Service Name",isMandatory:!0,type:"input-formik",formik:k},F={id:"description",label:"description",isMandatory:!0,type:"textarea-formik",rows:8,formik:k},I={type:"button",text:"Upload Image",classes:"font-weight-bold",onClick:function(){return document.getElementById("file").click()}},T=(0,l.useState)({type:"suubmit",text:"Submit",classes:"font-weight-bold",disabled:!k.isValid}),z=(0,a.Z)(T,2),D=z[0],A=z[1];(0,l.useEffect)((function(){A({type:"suubmit",text:"Submit",classes:"font-weight-bold",disabled:!k.isValid})}),[k.isValid]),(0,l.useEffect)((function(){k.validateForm()}),[]);var R=function(){var e=(0,s.Z)(c().mark((function e(){var n,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.e)(V);case 2:if(null===(s=e.sent)||void 0===s||null===(n=s.message)||void 0===n||!n.includes("duplicate key error collection")){e.next=6;break}return k.setFieldError("name","Service with this name already create."),e.abrupt("return");case 6:t(!1),i({show:!0,message:"Service added successfully",className:"success"}),m((function(e){return[].concat((0,p.Z)(e),[(0,r.Z)({},s)])}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=(0,s.Z)(c().mark((function e(){var t,r,s,a,i,l,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new FormData,r=k.values,s=r.name,a=r.description,i=r.file,t.append("image",i),t.append("name",s),t.append("description",a),l={Authorization:"Bearer ".concat(n),"content-type":"multipart/form-data"},e.next=8,w.postData(d.Y.CREATE_SERVICE,t,{headers:l});case 8:return o=e.sent,e.abrupt("return",o);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,s.Z)(c().mark((function e(){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.e)(P);case 2:if(null===(r=e.sent)||void 0===r||null===(n=r.message)||void 0===n||!n.includes("duplicate key error collection")){e.next=6;break}return k.setFieldError("name","Service with this name already create."),e.abrupt("return");case 6:t(!1),i({show:!0,message:"Service updated successfully",className:"success"}),g(r);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,s.Z)(c().mark((function e(){var t,r,s,a,i,l,o,u,m;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new FormData,r=k.values,s=r.id,a=r.name,i=r.description,(l=r.file)&&t.append("file",l),t.append("name",a),t.append("description",i),o={Authorization:"Bearer ".concat(n),"content-type":"multipart/form-data"},u="".concat(d.Y.UPDATE_SERVICE,"/").concat(s),e.next=9,w.patchData(u,t,{headers:o});case 9:return m=e.sent,e.abrupt("return",m);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,Z.jsxs)("div",{className:"serviceForm",children:[(0,Z.jsx)(v.Z.Header,{closeButton:!0,children:"ADD NEW SERVICE"}),(0,Z.jsxs)(v.Z.Body,{className:"pt-0",children:[(0,Z.jsx)("p",{className:"intro-text",children:"Hi Admin to add a new service please fill the below details"}),(0,Z.jsx)("form",{onSubmit:k.handleSubmit,children:(0,Z.jsxs)("div",{className:"row",children:[(0,Z.jsxs)("div",{className:"col-md-7",children:[(0,Z.jsx)(j.Z,(0,r.Z)({},C)),(0,Z.jsx)(j.Z,(0,r.Z)({},F))]}),(0,Z.jsxs)("div",{className:"col-md-5",children:[(0,Z.jsx)("label",{htmlFor:"serviceImage",className:"formControl-label",children:"* Image"}),(0,Z.jsx)("div",{children:(0,Z.jsx)(b.Z,(0,r.Z)({},I))}),(0,Z.jsx)("input",{type:"file",hidden:!0,accept:"image/png, image/jpeg, image/jpg",id:"file",onChange:function(e){k.setFieldValue("file",e.target.files[0]),function(e){if(e){var t=new FileReader;t.readAsDataURL(e),t.onload=function(){_(t.result)}}}(e.target.files[0])}}),(0,Z.jsx)("small",{className:"text-danger errorMsg",children:k.errors.file}),y&&(0,Z.jsx)("div",{className:"mt-3",children:(0,Z.jsx)("img",{src:y,alt:"Profile",className:"serviceForm__img"})})]}),(0,Z.jsx)("div",{className:"col-12 text-center",children:(0,Z.jsx)(b.Z,(0,r.Z)({},D))})]})})]})]})}));var E=n.p+"static/media/deleteIcon.db2d7b9aa3606b467a9ffe6f654c38a4.svg",k=n(5211),C=function(e){var t=e.message,n=e.handleClose,s={type:"button",text:"Yes",classes:"font-weight-bold ml-3",onClick:e.handleYes},a={type:"button",text:"No",classes:"font-weight-bold customButton-ghost",onClick:n};return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(v.Z.Header,{closeButton:!0,className:"pb-0"}),(0,Z.jsxs)(v.Z.Body,{children:[(0,Z.jsx)("p",{className:"font-weight-bold",children:t}),(0,Z.jsxs)("div",{className:"d-flex align-items-center justify-content-end",children:[(0,Z.jsx)(b.Z,(0,r.Z)({},a)),(0,Z.jsx)(b.Z,(0,r.Z)({},s))]})]})]})},F=n(2426),I=(0,g.zB)({userToken:w.r}),T=(0,S.$j)(I,(function(e){return{setToasterCofig:function(t){return e((0,N.g)(t))}}}))((function(e){var t=e._id,n=e.image,r=e.name,i=e.updatedAt,m=e.description,p=e.userToken,v=e.setToasterCofig,h=e.removeService,x=e.setServices,g=e.updateServices,j=(0,l.useContext)(o.D),b=(0,l.useState)(!1),w=(0,a.Z)(b,2),S=w[0],N=w[1],y=(0,l.useState)(!1),I=(0,a.Z)(y,2),T=I[0],z=I[1],D=function(){var e=(0,s.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.e)(A);case 2:e.sent,h(t),v({show:!0,message:"Service deleted successfully",className:"success"}),N(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=(0,s.Z)(c().mark((function e(){var n,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(d.Y.DELETE_SERVICE,"/").concat(t),r={Authorization:"Bearer ".concat(p)},e.next=4,j.deleteData(n,{headers:r});case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("div",{className:"row border-bottom mb-3",children:[(0,Z.jsx)("div",{className:"col-3",children:(0,Z.jsx)("div",{className:"adminServiceTile__img",children:(0,Z.jsx)("img",{src:n,alt:"serviceBannerImg",className:"h-100 w-100"})})}),(0,Z.jsxs)("div",{className:"col-9",children:[(0,Z.jsxs)("div",{className:"d-flex align-items-start justify-content-between",children:[(0,Z.jsxs)("div",{className:"adminServiceTile__heading mb-2",children:[(0,Z.jsx)("div",{className:"adminServiceTile__heading--title",children:r}),(0,Z.jsx)("div",{className:"adminServiceTile__heading--date",children:F(i).format("Do MMMM, YYYY")})]}),(0,Z.jsxs)("div",{className:"d-flex align-items-center justify-content-between adminServiceTile__icons",children:[(0,Z.jsx)("img",{src:k,alt:"editIcon",className:"mr-2",onClick:function(){return z(!0)}}),(0,Z.jsx)("img",{src:E,alt:"deleteIcon",onClick:function(){return N(!0)}})]})]}),(0,Z.jsx)("p",{className:"adminServiceTile__desc",children:m})]})]}),(0,Z.jsx)(f.Z,{show:S,size:"md",handleClose:function(){return N(!1)},children:(0,Z.jsx)(C,{message:"Do you want to delete this service?",handleClose:function(){return N(!1)},handleYes:D})}),(0,Z.jsx)(f.Z,{show:T,size:"lg",handleClose:function(){return z(!1)},children:(0,Z.jsx)(_,{setShow:z,setServices:x,data:{_id:t,image:n,name:r,description:m},updateServices:g})})]})})),z=function(){var e=(0,l.useContext)(o.D),t=(0,l.useState)(!1),n=(0,a.Z)(t,2),i=n[0],p=n[1],v=(0,l.useState)([]),h=(0,a.Z)(v,2),x=h[0],g=h[1],j=(0,l.useState)(1),b=(0,a.Z)(j,2),w=b[0],S=b[1],N=(0,l.useState)(4),y=(0,a.Z)(N,1)[0];(0,l.useEffect)((function(){E()}),[]);var E=function(){var e=(0,s.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.e)(k);case 2:t=e.sent,g(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var t=(0,s.Z)(c().mark((function t(){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getData(d.Y.VIEW_SERVICES);case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),C=function(e){var t=x.filter((function(t){return t._id!==e}));g(t)},F=function(e){var t=x.map((function(t){return t._id===e._id&&(t=(0,r.Z)({},e)),t}));g(t)};return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("div",{className:"adminServices container",children:[(0,Z.jsxs)("div",{className:"adminServices__header d-flex align-items-center justify-content-between",children:[(0,Z.jsxs)("h2",{children:["You have got ",x.length," Services"]}),(0,Z.jsx)("span",{onClick:function(){return p(!0)},children:"Add New Service"})]}),(0,Z.jsx)("div",{className:"adminServices__body",children:Array.isArray(x)&&x.length>0&&x.slice((w-1)*y,(w-1)*y+y).map((function(e,t){return(0,Z.jsx)(T,(0,r.Z)((0,r.Z)({},e),{},{removeService:C,setServices:g,updateServices:F}),t)}))}),(0,Z.jsx)("div",{className:"d-flex align-items-center justify-content-end mt-4",children:(0,Z.jsx)(m.Z,{records:x,pageSize:y,page:w,setPage:S})})]}),(0,Z.jsx)(f.Z,{show:i,size:"lg",handleClose:function(){return p(!1)},children:(0,Z.jsx)(_,{setShow:p,setServices:g})})]})}},7653:function(e,t,n){n.d(t,{Z:function(){return Z}});var r=n(2791),s=n(7462),a=n(3366),i=n(1694),c=n.n(i),l=n(162),o=n(2785),u=["active","disabled","className","style","activeLabel","children"],d=["children"],m=r.forwardRef((function(e,t){var n=e.active,i=e.disabled,l=e.className,d=e.style,m=e.activeLabel,f=e.children,p=(0,a.Z)(e,u),v=n||i?"span":o.Z;return r.createElement("li",{ref:t,style:d,className:c()(l,"page-item",{active:n,disabled:i})},r.createElement(v,(0,s.Z)({className:"page-link",disabled:i},p),f,n&&m&&r.createElement("span",{className:"sr-only"},m)))}));m.defaultProps={active:!1,disabled:!1,activeLabel:"(current)"},m.displayName="PageItem";var f=m;function p(e,t,n){function s(e){var s=e.children,i=(0,a.Z)(e,d);return r.createElement(m,i,r.createElement("span",{"aria-hidden":"true"},s||t),r.createElement("span",{className:"sr-only"},n))}return void 0===n&&(n=e),s.displayName=e,s}var v=p("First","\xab"),h=p("Prev","\u2039","Previous"),x=p("Ellipsis","\u2026","More"),g=p("Next","\u203a"),j=p("Last","\xbb"),b=["bsPrefix","className","children","size"],w=r.forwardRef((function(e,t){var n=e.bsPrefix,i=e.className,o=e.children,u=e.size,d=(0,a.Z)(e,b),m=(0,l.vE)(n,"pagination");return r.createElement("ul",(0,s.Z)({ref:t},d,{className:c()(i,m,u&&m+"-"+u)}),o)}));w.First=v,w.Prev=h,w.Ellipsis=x,w.Item=f,w.Next=g,w.Last=j;var S=w,N=n(184),Z=function(e){var t=e.records,n=e.pageSize,r=e.page,s=e.setPage;return(0,N.jsx)(S,{className:"customPagination",children:t.map((function(e,t){if(t%n===0)return(0,N.jsx)(S.Item,{active:t/n+1===r,onClick:function(){return s(0===t?1:t/n+1)},children:0===t?1:t/n+1},t+1)}))})}},5211:function(e,t,n){e.exports=n.p+"static/media/edit-icon.bfa5dc328c8514e18705.webp"}}]);
//# sourceMappingURL=45.a06f2280.chunk.js.map